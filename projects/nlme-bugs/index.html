<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.427">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Heather Turner and Ben Bolker">
<meta name="description" content="Addressing open bugs on the recommended package nlme for (non)linear mixed effect models.">

<title>R Project Sprint 2023 - Addressing Bugs in nlme</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../media/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="R Project Sprint 2023 - Addressing Bugs in nlme">
<meta property="og:description" content="Addressing open bugs on the recommended package nlme for (non)linear mixed effect models.">
<meta property="og:site-name" content="R Project Sprint 2023">
<meta name="twitter:title" content="R Project Sprint 2023 - Addressing Bugs in nlme">
<meta name="twitter:description" content="A 3-day meeting of R developers to work collaboratively on R core development, hosted at the University of Warwick, August 30 – September 1">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">R Project Sprint 2023</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../code-of-conduct.html" rel="" target="">
 <span class="menu-text">Code of Conduct</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../participants/index.html" rel="" target="">
 <span class="menu-text">Participants</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-projects" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Projects</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-projects">    
        <li>
    <a class="dropdown-item" href="../../projects/index.html" rel="" target="">
 <span class="dropdown-text">Projects</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../projects/ideas-and-proposals.html" rel="" target="">
 <span class="dropdown-text">Ideas and Proposals</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://mastodon.cloud/tags/RSprint2023" rel="" target=""><i class="bi bi-mastodon" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/hashtag/RSprint2023?src=hashtag_click" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/r-devel/r-project-sprint-2023" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background">Background</a></li>
  <li><a href="#problem-statement" id="toc-problem-statement" class="nav-link" data-scroll-target="#problem-statement">Problem statement</a></li>
  <li><a href="#proposed-solution" id="toc-proposed-solution" class="nav-link" data-scroll-target="#proposed-solution">Proposed solution</a></li>
  <li><a href="#testing" id="toc-testing" class="nav-link" data-scroll-target="#testing">Testing</a></li>
  <li><a href="#project-requirements" id="toc-project-requirements" class="nav-link" data-scroll-target="#project-requirements">Project requirements</a></li>
  <li><a href="#project-resources" id="toc-project-resources" class="nav-link" data-scroll-target="#project-resources">Project resources</a></li>
  <li><a href="#project-outcomes" id="toc-project-outcomes" class="nav-link" data-scroll-target="#project-outcomes">Project outcomes</a></li>
  <li><a href="#reactions-and-comments" id="toc-reactions-and-comments" class="nav-link" data-scroll-target="#reactions-and-comments">Reactions and comments</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Addressing Bugs in nlme</h1>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">C</div>
    <div class="quarto-category">Models</div>
  </div>
  </div>

<div>
  <div class="description">
    Addressing open bugs on the recommended package nlme for (non)linear mixed effect models.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Heather Turner and Ben Bolker </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<!-- 
This template is based on https://contributor.r-project.org/r-project-sprint-2023/projects/quartz-alpha-mask/.
The sections are provided as a guide and may not be appropriate to your proposal, feel free to skip or change sections.

Please label any R code chunks, especially those producing images.
-->
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>The <strong>nlme</strong> package (maintained by R-core) has a medium-sized list of bugs reported, reaching back over 5 years. In some cases there is already a patch or a proposed solution. Other cases require some discussion or further debugging to determine an appropriate solution. Often only the R code is affected and the problem is more about determining the correct behaviour rather than debugging low-level code, though that will be required in the hardest cases.</p>
<p>This project would suit a group of people working in twos or threes, with each small group aiming to close one or two bugs during the sprint.</p>
<p>The <strong>nlme</strong> package is version controlled in a Subversion repository, available at <a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="uri">https://svn.r-project.org/R-packages/trunk/nlme/</a>.</p>
</section>
<section id="problem-statement" class="level2">
<h2 class="anchored" data-anchor-id="problem-statement">Problem statement</h2>
<p>The list of <strong>nlme</strong> bugs on <a href="https://bugs.r-project.org/">R’s Bugzilla</a> as of 23 June 2023 is summarised below:</p>
<table class="table">
<thead>
<tr class="header">
<th>Bug&nbsp;ID</th>
<th>Level</th>
<th>Status</th>
<th>Topic</th>
<th>Action(s)</th>
<th>Programming skills</th>
<th>Statistical knowledge</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://bugs.r-project.org/show_bug.cgi?id=18505">18505</a></td>
<td>Novice</td>
<td>patch available</td>
<td>behaviour changing with order of group variable</td>
<td>check patch</td>
<td>R</td>
<td></td>
</tr>
<tr class="even">
<td><a href="https://bugs.r-project.org/show_bug.cgi?id=17884">17884</a></td>
<td>Novice</td>
<td>patch available</td>
<td>new confint.lme method for fixed effects only</td>
<td>check patch</td>
<td>R</td>
<td>confidence intervals</td>
</tr>
<tr class="odd">
<td><a href="https://bugs.r-project.org/show_bug.cgi?id=17988">17988</a></td>
<td>Novice</td>
<td>suggested solution</td>
<td>what to return for corARMA with p = q = 0</td>
<td>check patch, update doc</td>
<td>R</td>
<td></td>
</tr>
<tr class="even">
<td><a href="https://bugs.r-project.org/show_bug.cgi?id=18472">18472</a></td>
<td>Intermediate</td>
<td>needs reprex</td>
<td>correct behaviour of gls</td>
<td>create reprex, discuss</td>
<td>R</td>
<td>gls</td>
</tr>
<tr class="odd">
<td><a href="https://bugs.r-project.org/show_bug.cgi?id=17712">17712</a></td>
<td>Intermediate</td>
<td>suggested solution</td>
<td>conditions when algorithm should use decomposition</td>
<td>create patch, check patch</td>
<td>R</td>
<td></td>
</tr>
<tr class="even">
<td><a href="https://bugs.r-project.org/show_bug.cgi?id=18285">18285</a></td>
<td>Intermediate</td>
<td>suggested solution</td>
<td>how to handle rank deficiency</td>
<td>discuss, create reprex, create patch</td>
<td>R</td>
<td>rank deficiency</td>
</tr>
<tr class="odd">
<td><a href="https://bugs.r-project.org/show_bug.cgi?id=17961">17961</a></td>
<td>Intermediate</td>
<td>unclear if bug or not</td>
<td>appropriate df to use in tests</td>
<td>discuss</td>
<td>R</td>
<td>anova tests</td>
</tr>
<tr class="even">
<td><a href="https://bugs.r-project.org/show_bug.cgi?id=17866">17866</a></td>
<td>Intermediate</td>
<td>reprex available</td>
<td>Initializing corStruct outside gls call gives different results</td>
<td>debug</td>
<td>R</td>
<td></td>
</tr>
<tr class="odd">
<td><a href="https://bugs.r-project.org/show_bug.cgi?id=16890">16890</a></td>
<td>Intermediate</td>
<td>patch welcome</td>
<td>intervals.lmList does not work for with pool = FALSE</td>
<td>create patch</td>
<td>R</td>
<td></td>
</tr>
<tr class="even">
<td><a href="https://bugs.r-project.org/show_bug.cgi?id=18192">18192</a></td>
<td>Intermediate</td>
<td>needs analysis</td>
<td>crash in nlme equivalent to lme model</td>
<td>debug R/C</td>
<td>C</td>
<td></td>
</tr>
<tr class="odd">
<td><a href="https://bugs.r-project.org/show_bug.cgi?id=17227">17227</a></td>
<td>Intermediate</td>
<td>partial analysis available</td>
<td>crash in nlme</td>
<td>debug R/C</td>
<td>C</td>
<td></td>
</tr>
<tr class="even">
<td><a href="https://bugs.r-project.org/show_bug.cgi?id=16864">16864</a></td>
<td>Advanced</td>
<td>needs analysis</td>
<td>lme fails to warn when data are near-redundant</td>
<td>debug R/C/Fortran</td>
<td>R, C, Fortran</td>
<td></td>
</tr>
<tr class="odd">
<td><a href="https://bugs.r-project.org/show_bug.cgi?id=16975">16975</a></td>
<td>Advanced</td>
<td>needs analysis</td>
<td>REML estimation incorrect with fixed sigma</td>
<td>debug</td>
<td>R, C</td>
<td></td>
</tr>
<tr class="even">
<td><a href="https://bugs.r-project.org/show_bug.cgi?id=17236">17236</a></td>
<td>Advanced</td>
<td>needs support from R Core</td>
<td>Correct df for intercept in lme</td>
<td>discuss, create patch, check patch</td>
<td>R</td>
<td></td>
</tr>
<tr class="odd">
<td><a href="https://bugs.r-project.org/show_bug.cgi?id=18433">18433</a></td>
<td>Advanced</td>
<td>needs reprex</td>
<td>infinite loop dependent on random seed</td>
<td>create reprex, debug</td>
<td>C, Docker</td>
<td>nlme algorithms</td>
</tr>
<tr class="even">
<td><a href="https://bugs.r-project.org/show_bug.cgi?id=16806">16806</a></td>
<td>Advanced</td>
<td>patch welcome</td>
<td>method fails for individuals with single observations</td>
<td>create patch</td>
<td>C</td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="proposed-solution" class="level2">
<h2 class="anchored" data-anchor-id="proposed-solution">Proposed solution</h2>
<p>The table in the last section summarises the next action(s) required to address the different bugs. In more detail:</p>
<ul>
<li><p><strong>check patch</strong></p>
<ul>
<li><p>Check the bug is still present in the development version of <strong>nlme</strong>.</p></li>
<li><p>Apply the patch to the <strong>nlme</strong> sources, build and install the package, and test a reprex to confirm the patch fixes the issue.</p></li>
<li><p>Run R CMD check on the built package to check nothing is broken by the change.</p></li>
</ul></li>
<li><p><strong>update doc</strong></p>
<ul>
<li><p>Modify the source of the documentation file in the <strong>nlme</strong> sources.</p></li>
<li><p>Review your changes (e.g.&nbsp;Preview in RStudio or build and install to view).</p></li>
<li><p>Create a patch to include both code and documentation changes.</p></li>
</ul></li>
<li><p><strong>create reprex</strong></p>
<ul>
<li>Create a minimal, reproducible example, using only base R packages plus <strong>nlme</strong>, that demonstrates the issue. In complex cases, this may require creating a Docker image so that the whole environment is reproducible.</li>
</ul></li>
<li><p><strong>discuss</strong></p>
<ul>
<li>Discuss what the appropriate behaviour of the code should be, or discuss a proposal to clarify the way forward. Summarize conclusions on Bugzilla or agree a way forward with a member of R Core.</li>
</ul></li>
<li><p><strong>debug</strong></p>
<ul>
<li>Identify the parts of the code that are the root cause of the issue. This may not always be code that triggers an error, but code that does not produce the correct result in particular circumstances.</li>
</ul></li>
<li><p><strong>create patch</strong></p>
<ul>
<li>Modify the R and/or C source code to implement a proposed change. This can involve substantial work to determine the appropriate changes to make and may be an iterative process with feedback from others.</li>
</ul></li>
</ul>
</section>
<section id="testing" class="level2">
<h2 class="anchored" data-anchor-id="testing">Testing</h2>
<p>In general, we will rely on the tests included in the <strong>nlme</strong> package. It may be appropriate to propose additions to this test suite to cover the code added/modified when addressing a bug report.</p>
<p>We may also run reverse dependency checks to check changes do not break packages that depend on <strong>nlme</strong>.</p>
</section>
<section id="project-requirements" class="level2">
<h2 class="anchored" data-anchor-id="project-requirements">Project requirements</h2>
<p>Familiarity with Subversion will be helpful, however note that you can create a RStudio package project from the repository URL: <a href="https://svn.r-project.org/R-packages/trunk/nlme/" class="uri">https://svn.r-project.org/R-packages/trunk/nlme/</a>.</p>
<p>Familiarity with R package development will be helpful, though again RStudio makes it simple to run R CMD check on the package or to build and install from source. Note that documentation in <strong>nlme</strong> is written directly in <code>.Rd</code> format.</p>
<p>On MacOS you should have the <a href="https://mac.r-project.org/tools/">mandatory development tools</a>, Xcode and GNU Fortran installed.</p>
<p>On Windows you should have <a href="https://cran.r-project.org/bin/windows/Rtools/rtools43/rtools.html">RTools</a> installed.</p>
</section>
<section id="project-resources" class="level2">
<h2 class="anchored" data-anchor-id="project-resources">Project resources</h2>
<ul>
<li><p><a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Writing-R-documentation-files">Writing R documentation files</a></p></li>
<li><p><a href="https://link.springer.com/book/10.1007/b98882">Mixed-Effects Models in S and S-PLUS</a>, José C. Pinheiro and Douglas M. Bates - we will have at least one copy of this book available at the sprint.</p></li>
</ul>
</section>
<section id="project-outcomes" class="level2">
<h2 class="anchored" data-anchor-id="project-outcomes">Project outcomes</h2>
<p>Contribution to a recommended package (potentially acknowledged in the ChangeLog).</p>
<p>Experience with the package development process.</p>
<p>Experience with creating/applying patches with Subversion.</p>
<p>Experiences working with bug reports on Bugzilla.</p>
</section>
<section id="reactions-and-comments" class="level2">
<h2 class="anchored" data-anchor-id="reactions-and-comments">Reactions and comments</h2>
<!-- 
Please leave the Reactions and comments section
- a Giscus comment box will be automatically added here 
-->


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="r-devel/r-project-sprint-2023" data-repo-id="R_kgDOIhAibA" data-category="Proposals" data-category-id="DIC_kwDOIhAibM4CW3GY" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" data-loading="lazy" async="">
</script>
</div> <!-- /content -->



</body></html>